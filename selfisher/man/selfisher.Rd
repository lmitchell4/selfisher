% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/selfisher.R
\name{selfisher}
\alias{selfisher}
\title{Fit gear selectivity models with TMB}
\usage{
selfisher(rformula, data = NULL, pformula = ~1, dformula = ~1,
  psplit = FALSE, x0 = NULL, link = "logit", total = NULL,
  haul = NULL, offset = NULL, Lp = "basic", se = TRUE,
  verbose = FALSE, debug = FALSE, optControl = list(iter.max = 300,
  eval.max = 400))
}
\arguments{
\item{rformula}{combined fixed and random effects formula for the selectivity model, following lme4
syntax. The left-hand side of the formula should be the proportion of fish entering the test gear.}

\item{data}{data frame}

\item{pformula}{a \emph{one-sided} (i.e., no response variable) formula for
    the ralaive fishing power of the test versus the control gear combining fixed and random effects:
\code{~0} can be used to specify equal fishing power (p=0.5).
The relative fishing power model uses a logit link.}

\item{dformula}{a formula for the delta parameter in Richards selection curve. Ignored unless \code{link="richards"}.}

\item{psplit}{(logical) Does the model contain psplit as in eqn 3 of Wileman et al. 1996? For covered codend and catch comparison, use psplit=FALSE.}

\item{x0}{vector of initial values for the size selectivity model}

\item{link}{A character indicating the link function for the selectivity model.
\code{"logit"}(logistic) is the default, but other options are "probit" (i.e. normal probability ogiv), "cloglog" (i.e. negative extreme value), "loglog" (i.e. extreme value/Gompert), or "Richards"}

\item{total}{The number of total fish caught in the test and control gear.}

\item{haul}{Name of column representing different hauls. Needed for double bootstrap.}

\item{Lp}{controls calculation of length (L) at retention prob (p), see details}

\item{se}{whether to return standard errors}

\item{verbose}{logical indicating if some progress indication should be printed to the console.}

\item{debug}{whether to return the preprocessed data and parameter objects,
without fitting the model}

\item{optControl}{control parameters passed to \code{nlminb}}
}
\description{
Fit gear selectivity models with TMB
}
\details{
\itemize{
\item in all cases \code{selfisher} returns maximum likelihood estimates.
\item You only need to specify \code{haul} in models that are going to be bootstraped with type="double".
\item Lp="basic" will return values for L50 and SR.
\item Lp="none" supresses calculation of L50 and SR to save time.
\item Lp="full" will return values of Lp for p=5 to 95 as well as SR
\item Lp="100" will return values of Lp for p=1 to 100 as well as SR
\item Use \code{getCapabilities()} to see options for links and RE
}
}
\examples{
dat <- transform(haddock, tot=nfine+nwide, prop=nwide/(nfine+nwide))
m0 <- selfisher(prop~Lengths, p=~0, psplit=TRUE, total=tot, dat)
m1 <- selfisher(prop~Lengths, p=~1, psplit=TRUE, total=tot, dat)
}
